@startuml
'Object Colors Setting
skinparam defaultFontName Arial
skinparam defaultFontSize 12

legend top
|=        Elements  |=           Colors  |
| Microcontroller  |<back:#A0522D>                                    |
| System  |<back:#9370DB>                                    |
| Layer  |<back:#FEE599>                                    |
| Component |<back:#E0FFFF>                                    |
| Module |<back:#E2EFD9>                                    |
| Uint |<back:#7FFFD4>                                    |
| Tiny |<back:#FFC0CB>                                    |
endlegend

skinparam rectangle {
    BackgroundColor #87CEFA
    BorderColor #000000
}

'---- App Component ----
package "SWDD-001\nApp" as App #E0FFFF{
    '---- Module ----
  component "SWDD-001-001\nmain.c" as main #E2EFD9 {
    ' Units
    [App State Machine] as AppSm #7FFFD4
  }

  component "SWDD-001-004\nSmApp.c" as SmApp #E2EFD9 {
    ' Units
    [Init State] as SM_INIT #7FFFD4
    [Task State] as SM_TASK #7FFFD4
    [Sleep State] as SM_SLEEP #7FFFD4
  }
  
  component "SWDD-001-002\nInitApp.c" as InitApp #E2EFD9 {
    ' Units
    [Init Interfaces] as InitIfApp #7FFFD4
  }

  component "SWDD-001-003\nPinIoApp.c" as PinIoApp #E2EFD9 {
    ' Units
    [Init PinIOs] as InitPinIoApp #7FFFD4
  }

  component "SWDD-001-006\nTaskApp.c" as TaskApp #E2EFD9{
    ' Units
    [Task 100ms] as Task100msApp #7FFFD4
    [Task 1s] as Task1sApp #7FFFD4
  }

  component "SWDD-001-007\nClkApp.c" as ClkApp #E2EFD9 {
    ' Units
    [Init Clocks] as InitClkApp #7FFFD4
  }

  component "SWDD-001-005\nRtosApp.c" as RtosApp #E2EFD9 {
    ' Units
    [Init Task] as InitTaskApp #7FFFD4
    [Task 100ms Process] as Task100msProcessApp #7FFFD4
    [Task 1s Process] as Task1sProcessApp #7FFFD4
  }
  '----------------
}

'---- Service Component ----
package "SWDD-002\nService" as Service #E0FFFF {
  '---- Module ----
  component "SWDD-002-001\nUds.c" as UdsService #E2EFD9 {
    ' Units
    [SWDD-002-001-001 Init UDS] as InitUds #7FFFD4
    [SWDD-002-001-002 UDS_MainFunction] as UdsMainFunction #7FFFD4
    [SWDD-002-001-003 UDS_ProcessRequest] as UdsProcessRequest #7FFFD4
    [SWDD-002-001-004 UDS_TransmitResponse] as UdsTransmitResponse #7FFFD4
    [SWDD-002-001-005 UDS_ProcessDiagnosticSessionControl] as UdsProcessDiagnosticSessionControl #7FFFD4
    [SWDD-002-001-006 UDS_ProcessEcuReset] as UdsProcessEcuReset #7FFFD4
    [SWDD-002-001-007 UDS_ProcessTesterPresent] as UdsProcessTesterPresent #7FFFD4
    [SWDD-002-001-008 UDS_Session_IsAllowed] as UdsSessionIsAllowed1 #7FFFD4
    [SWDD-002-001-009 UDS_Session_IsAllowed] as UdsSessionIsAllowed2 #7FFFD4
    [SWDD-002-001-010 UDS_Session_Change] as UdsSessionChange #7FFFD4
    [SWDD-002-001-011 UDS_Session_Init] as UdsSessionInit #7FFFD4
    [SWDD-002-001-012 UDS_ProcessRequestDownload] as UdsProcessRequestDownload #7FFFD4
    [SWDD-002-001-013 UDS_ProcessTransferData] as UdsProcessTransferData #7FFFD4
    [SWDD-002-001-014 UDS_ProcessRequestTransferExit] as UdsProcessRequestTransferExit #7FFFD4
    [SWDD-002-001-015 UDS_ProcessRoutineControl] as UdsProcessRoutineControl #7FFFD4
    [SWDD-002-001-016 CANTP Functions] as CANTP #7FFFD4
    [SWDD-002-001-017 DCM Functions] as DCM #7FFFD4
    [SWDD-002-001-018 DEM Functions] as DEM #7FFFD4
    [SWDD-002-001-019 NVM Functions] as NVM #7FFFD4
  }

  component "SWDD-002-002\nFuSa.c" as FuSaService #E2EFD9 {
    ' Units
  }

  component "SWDD-002-003\nSecurity.c" as SecurityService #E2EFD9 {
    ' Units
  }
  '----------------
}

'---- HAL Component ----
package "SWDD-003\nHAL" as HAL #E0FFFF {
  '---- Module ----
  component "SWDD-003-001\nClkHal.c" as ClkHal #E2EFD9 {
    ' Units
    [Init Clocks for HAL] as InitClkHal #7FFFD4
  }

  component "SWDD-003-002\nPinIoHal.c" as PinIoHal #E2EFD9 {
    ' Units
    [Init PinIO for HAL] as InitPinIOHal #7FFFD4
    [PinIO Output Control for HAL] as PinIoOutHal #7FFFD4
  }
  '----------------
}

'---- OS Component ----
package "SWDD-004\nOS" as OS #E0FFFF {
  '---- Module ----
  component "freeRTOS Modules" as freeRTOSModules #E2EFD9 {
    ' Units
  }
  '----------------
}

'---- Drivers Component ----
package "SWDD-005\nDrivers" as Drivers #E0FFFF {
  '---- Module ----
  component "SWDD-005-001\nClkDrv.c" as ClkDrv #E2EFD9 {
    ' Units
    [Init Clocks Driver] as InitClkDrv #7FFFD4
  }

  component "SWDD-005-002\nPinIoDrv.c" as PinIoDrv #E2EFD9 {
    ' Units
    [Init PinIO Driver] as InitPinIODrv #7FFFD4
    [PinIO Output Control Driver] as PinIoOutDrv #7FFFD4
  }
  '----------------
}

'---- join modules ----
AppSm --> SmApp
SM_INIT --> InitApp
SM_TASK --> TaskApp
InitIfApp --> InitClkApp
InitClkApp --> InitClkHal
InitClkHal --> InitClkDrv

InitIfApp --> InitPinIoApp
InitPinIoApp --> InitPinIOHal
InitPinIOHal --> InitPinIODrv

InitIfApp --> InitTaskApp
Task100msProcessApp --> Task100msApp
Task1sProcessApp --> Task1sApp
Task1sApp --> PinIoOutHal
PinIoOutHal --> PinIoOutDrv
'----------------------

@enduml



@startuml
'Object Colors Setting
skinparam defaultFontName Arial
skinparam defaultFontSize 12

legend top
|=        Object  |=           Colors  |
| Microcontroller  |<back:#A0522D>                                    |
| System  |<back:#9370DB>                                    |
| Layer  |<back:#FEE599>                                    |
| Component |<back:#E0FFFF>                                    |
| Module |<back:#E2EFD9>                                    |
| Unit |<back:#7FFFD4>                                    |
| Tiny |<back:#FFC0CB>                                    |
endlegend

skinparam rectangle {
    BackgroundColor #87CEFA
    BorderColor #000000
}

'---- CANTP Module ----
component "SWDD-002-001-016\nCANTP.c" as CANTPModule #7FFFD4 {
    [SWDD-002-001-016-001 CanTp_LoadConfig] as CanTp_LoadConfig #FFC0CB
    [SWDD-002-001-016-002 CanTp_GetMaxPayloadLength] as CanTp_GetMaxPayloadLength #FFC0CB
    [SWDD-002-001-016-003 CanTp_GetSTmin] as CanTp_GetSTmin #FFC0CB
    [SWDD-002-001-016-004 CanTp_GetBS] as CanTp_GetBS #FFC0CB
    [SWDD-002-001-016-005 CanTp_GetN_As] as CanTp_GetN_As #FFC0CB
    [SWDD-002-001-016-006 CanTp_GetN_Bs] as CanTp_GetN_Bs #FFC0CB
    [SWDD-002-001-016-007 CanTp_GetN_Cr] as CanTp_GetN_Cr #FFC0CB
    [SWDD-002-001-016-008 CanTp_Manager_Init] as CanTp_Manager_Init #FFC0CB
    [SWDD-002-001-016-009 CanTp_Manager_MainFunction] as CanTp_Manager_MainFunction #FFC0CB
    [SWDD-002-001-016-010 CanTp_Manager_StartTransmission] as CanTp_Manager_StartTransmission #FFC0CB
    [SWDD-002-001-016-011 CanTp_ProcessSingleFrame] as CanTp_ProcessSingleFrame #FFC0CB
    [SWDD-002-001-016-012 CanTp_Manager_ProcessReceivedFrame] as CanTp_Manager_ProcessReceivedFrame #FFC0CB
    [SWDD-002-001-016-013 CanTp_ProcessFirstFrame] as CanTp_ProcessFirstFrame #FFC0CB
    [SWDD-002-001-016-014 CanTp_ProcessConsecutiveFrame] as CanTp_ProcessConsecutiveFrame #FFC0CB
    [SWDD-002-001-016-015 CanTp_ProcessFlowControlFrame] as CanTp_ProcessFlowControlFrame #FFC0CB
    [SWDD-002-001-016-016 CanTp_Manager_GetReceivedData] as CanTp_Manager_GetReceivedData #FFC0CB
    [SWDD-002-001-016-017 CanTp_SendConsecutiveFrame] as CanTp_SendConsecutiveFrame #FFC0CB
    [SWDD-002-001-016-018 CanTp_SendFlowControlFrame] as CanTp_SendFlowControlFrame #FFC0CB
    [SWDD-002-001-016-019 CanTp_SendFrame] as CanTp_SendFrame #FFC0CB
    [SWDD-002-001-016-020 CanTp_GetCurrentTime] as CanTp_GetCurrentTime #FFC0CB
    [SWDD-002-001-016-021 CanTp_RxIndication] as CanTp_RxIndication #FFC0CB
    [SWDD-002-001-016-022 CanTp_Utils_BuildSingleFrame] as CanTp_Utils_BuildSingleFrame #FFC0CB
    [SWDD-002-001-016-023 CanTp_Utils_BuildFirstFrame] as CanTp_Utils_BuildFirstFrame #FFC0CB
    [SWDD-002-001-016-024 CanTp_Utils_BuildConsecutiveFrame] as CanTp_Utils_BuildConsecutiveFrame #FFC0CB
    [SWDD-002-001-016-025 CanTp_Utils_BuildFlowControlFrame] as CanTp_Utils_BuildFlowControlFrame #FFC0CB
    [SWDD-002-001-016-026 CanTp_Init] as CanTp_Init #FFC0CB
    [SWDD-002-001-016-027 CanTp_MainFunction] as CanTp_MainFunction #FFC0CB
    [SWDD-002-001-016-028 CanTp_Transmit] as CanTp_Transmit #FFC0CB
    [SWDD-002-001-016-029 CanTp_Receive] as CanTp_Receive #FFC0CB
}

'---- DCM Module ----
component "SWDD-002-001-017\nDCM.c" as DCMModule #7FFFD4 {
    [SWDD-002-001-017-001 DCM_Init] as DCM_Init #FFC0CB
    [SWDD-002-001-017-002 DCM_Session_Init] as DCM_Session_Init #FFC0CB
    [SWDD-002-001-017-003 DCM_Security_Init] as DCM_Security_Init #FFC0CB
    [SWDD-002-001-017-004 DCM_DIDManager_Init] as DCM_DIDManager_Init #FFC0CB
    [SWDD-002-001-017-005 DCM_MainFunction] as DCM_MainFunction #FFC0CB
    [SWDD-002-001-017-006 DCM_Session_MainFunction] as DCM_Session_MainFunction #FFC0CB
    [SWDD-002-001-017-007 DCM_Security_MainFunction] as DCM_Security_MainFunction #FFC0CB
    [SWDD-002-001-017-008 DCM_ProcessRequest] as DCM_ProcessRequest #FFC0CB
    [SWDD-002-001-017-009 DCM_CheckPreconditions] as DCM_CheckPreconditions #FFC0CB
    [SWDD-002-001-017-010 DCM_RegisterDID] as DCM_RegisterDID #FFC0CB
    [SWDD-002-001-017-011 DCM_GetDIDInfo] as DCM_GetDIDInfo #FFC0CB
    [SWDD-002-001-017-012 DCM_CheckSessionAllowed] as DCM_CheckSessionAllowed #FFC0CB
    [SWDD-002-001-017-013 DCM_LogRequest] as DCM_LogRequest #FFC0CB
    [SWDD-002-001-017-014 DCM_CalculateChecksum] as DCM_CalculateChecksum #FFC0CB
    [SWDD-002-001-017-015 DCM_LoadConfig] as DCM_LoadConfig #FFC0CB
    [SWDD-002-001-017-016 DCM_DIDManager_RegisterDID] as DCM_DIDManager_RegisterDID #FFC0CB
    [SWDD-002-001-017-017 DCM_DIDManager_GetDIDInfo] as DCM_DIDManager_GetDIDInfo #FFC0CB
    [SWDD-002-001-017-018 DCM_GetScalingInfo] as DCM_GetScalingInfo #FFC0CB
    [SWDD-002-001-017-019 DCM_Security_GetSeed] as DCM_Security_GetSeed #FFC0CB
    [SWDD-002-001-017-020 DCM_Security_CompareKey] as DCM_Security_CompareKey #FFC0CB
    [SWDD-002-001-017-021 DCM_Security_IsLevelUnlocked] as DCM_Security_IsLevelUnlocked #FFC0CB
    [SWDD-002-001-017-022 DCM_Security_LockAll] as DCM_Security_LockAll #FFC0CB
    [SWDD-002-001-017-023 DCM_ProcessReadDataByIdentifier] as DCM_ProcessReadDataByIdentifier #FFC0CB
    [SWDD-002-001-017-024 DCM_ProcessWriteDataByIdentifier] as DCM_ProcessWriteDataByIdentifier #FFC0CB
    [SWDD-002-001-017-025 DCM_ProcessReadScalingDataByIdentifier] as DCM_ProcessReadScalingDataByIdentifier #FFC0CB
    [SWDD-002-001-017-026 UDS_ProcessSecurityAccess] as UDS_ProcessSecurityAccess #FFC0CB
    [SWDD-002-001-017-027 UDS_ProcessReadDataByIdentifier] as UDS_ProcessReadDataByIdentifier #FFC0CB
    [SWDD-002-001-017-028 UDS_ProcessWriteDataByIdentifier] as UDS_ProcessWriteDataByIdentifier #FFC0CB
    [SWDD-002-001-017-029 UDS_ProcessReadMemoryByAddress] as UDS_ProcessReadMemoryByAddress #FFC0CB
    [SWDD-002-001-017-030 UDS_ProcessWriteMemoryByAddress] as UDS_ProcessWriteMemoryByAddress #FFC0CB
    [SWDD-002-001-017-031 DCM_Session_Change] as DCM_Session_Change #FFC0CB
    [SWDD-002-001-017-032 DCM_Session_GetCurrent] as DCM_Session_GetCurrent #FFC0CB
    [SWDD-002-001-017-033 DCM_Session_IsServiceAllowed] as DCM_Session_IsServiceAllowed #FFC0CB
}

'---- DEM Module ----
component "SWDD-002-001-018\nDEM.c" as DEMModule #7FFFD4 {
    [SWDD-002-001-018-001 DEM_LoadConfig] as DEM_LoadConfig #FFC0CB
    [SWDD-002-001-018-002 DEM_EventManager_Init] as DEM_EventManager_Init #FFC0CB
    [SWDD-002-001-018-003 DEM_EventManager_SaveToNVM] as DEM_EventManager_SaveToNVM #FFC0CB
    [SWDD-002-001-018-004 DEM_EventManager_LoadFromNVM] as DEM_EventManager_LoadFromNVM #FFC0CB
    [SWDD-002-001-018-005 DEM_EventManager_ReportEvent] as DEM_EventManager_ReportEvent #FFC0CB
    [SWDD-002-001-018-006 DEM_EventManager_GetEventStatus] as DEM_EventManager_GetEventStatus #FFC0CB
    [SWDD-002-001-018-007 DEM_EventManager_GetFreezeFrameData] as DEM_EventManager_GetFreezeFrameData #FFC0CB
    [SWDD-002-001-018-008 DEM_EventManager_GetEnvironmentData] as DEM_EventManager_GetEnvironmentData #FFC0CB
    [SWDD-002-001-018-009 DEM_EventManager_ProcessAging] as DEM_EventManager_ProcessAging #FFC0CB
    [SWDD-002-001-018-010 DEM_EventManager_HandleMultipleFaults] as DEM_EventManager_HandleMultipleFaults #FFC0CB
    [SWDD-002-001-018-011 DEM_Internal_FindEvent] as DEM_Internal_FindEvent #FFC0CB
    [SWDD-002-001-018-012 DEM_Internal_CaptureEnvironmentData] as DEM_Internal_CaptureEnvironmentData #FFC0CB
    [SWDD-002-001-018-013 DEM_Internal_CaptureFreezeFrameData] as DEM_Internal_CaptureFreezeFrameData #FFC0CB
    [SWDD-002-001-018-014 DEM_GetDTCStatusAvailabilityMask] as DEM_GetDTCStatusAvailabilityMask #FFC0CB
    [SWDD-002-001-018-015 DEM_GetStatusOfDTC] as DEM_GetStatusOfDTC #FFC0CB
    [SWDD-002-001-018-016 DEM_SetEventStatus] as DEM_SetEventStatus #FFC0CB
    [SWDD-002-001-018-017 DEM_GetEventStatus] as DEM_GetEventStatus #FFC0CB
    [SWDD-002-001-018-018 DEM_SetProtocol] as DEM_SetProtocol #FFC0CB
    [SWDD-002-001-018-019 DEM_TranslateEventToProtocol] as DEM_TranslateEventToProtocol #FFC0CB
    [SWDD-002-001-018-020 DEM_ProcessSecurityAccess] as DEM_ProcessSecurityAccess #FFC0CB
    [SWDD-002-001-018-021 DEM_ProcessCommunicationControl] as DEM_ProcessCommunicationControl #FFC0CB
    [SWDD-002-001-018-022 DEM_ProcessControlDTCSetting] as DEM_ProcessControlDTCSetting #FFC0CB
    [SWDD-002-001-018-023 DEM_Session_Init] as DEM_Session_Init #FFC0CB
    [SWDD-002-001-018-024 DEM_Session_Change] as DEM_Session_Change #FFC0CB
    [SWDD-002-001-018-025 DEM_Session_GetCurrent] as DEM_Session_GetCurrent #FFC0CB
    [SWDD-002-001-018-026 DEM_Session_IsAllowed] as DEM_Session_IsAllowed #FFC0CB
    [SWDD-002-001-018-027 DEM_CheckSessionAllowed] as DEM_CheckSessionAllowed #FFC0CB
    [SWDD-002-001-018-028 DEM_LogEvent] as DEM_LogEvent #FFC0CB
    [SWDD-002-001-018-029 DEM_CalculateEventChecksum] as DEM_CalculateEventChecksum #FFC0CB
    [SWDD-002-001-018-030 DEM_Init] as DEM_Init #FFC0CB
    [SWDD-002-001-018-031 DEM_MainFunction] as DEM_MainFunction #FFC0CB
    [SWDD-002-001-018-032 DEM_ProcessService] as DEM_ProcessService #FFC0CB
}

'---- NVM Module ----
component "SWDD-002-001-019\nNVM.c" as NVMModule #7FFFD4 {
    [SWDD-002-001-019-001 NVM_LoadConfig] as NVM_LoadConfig #FFC0CB
    [SWDD-002-001-019-002 NVM_ErrorHandler_Init] as NVM_ErrorHandler_Init #FFC0CB
    [SWDD-002-001-019-003 NVM_ErrorHandler_ReportError] as NVM_ErrorHandler_ReportError #FFC0CB
    [SWDD-002-001-019-004 NVM_ErrorHandler_GetLastError] as NVM_ErrorHandler_GetLastError #FFC0CB
    [SWDD-002-001-019-005 NVM_ErrorHandler_ClearLastError] as NVM_ErrorHandler_ClearLastError #FFC0CB
    [SWDD-002-001-019-006 NVM_ErrorHandler_Recover] as NVM_ErrorHandler_Recover #FFC0CB
    [SWDD-002-001-019-007 NVM_CalculateCRC32] as NVM_CalculateCRC32 #FFC0CB
    [SWDD-002-001-019-008 NVM_VerifyDataIntegrity] as NVM_VerifyDataIntegrity #FFC0CB
    [SWDD-002-001-019-009 NVM_AppendCRC32] as NVM_AppendCRC32 #FFC0CB
    [SWDD-002-001-019-010 NVM_MemoryManager_Init] as NVM_MemoryManager_Init #FFC0CB
    [SWDD-002-001-019-011 NVM_CheckAddressRange] as NVM_CheckAddressRange #FFC0CB
    [SWDD-002-001-019-012 NVM_ReadMemory] as NVM_ReadMemory #FFC0CB
    [SWDD-002-001-019-013 NVM_WriteMemory] as NVM_WriteMemory #FFC0CB
    [SWDD-002-001-019-014 NVM_EraseMemory] as NVM_EraseMemory #FFC0CB
    [SWDD-002-001-019-015 NVM_GetBlockInfo] as NVM_GetBlockInfo #FFC0CB
    [SWDD-002-001-019-016 NVM_Security_Init] as NVM_Security_Init #FFC0CB
    [SWDD-002-001-019-017 NVM_Security_SetAccessLevel] as NVM_Security_SetAccessLevel #FFC0CB
    [SWDD-002-001-019-018 NVM_Security_GetAccessLevel] as NVM_Security_GetAccessLevel #FFC0CB
    [SWDD-002-001-019-019 NVM_Security_IsOperationAllowed] as NVM_Security_IsOperationAllowed #FFC0CB
    [SWDD-002-001-019-020 NVM_ProcessReadMemoryByAddress] as NVM_ProcessReadMemoryByAddress #FFC0CB
    [SWDD-002-001-019-021 NVM_ProcessWriteMemoryByAddress] as NVM_ProcessWriteMemoryByAddress #FFC0CB
    [SWDD-002-001-019-022 NVM_ProcessRequestDownload] as NVM_ProcessRequestDownload #FFC0CB
    [SWDD-002-001-019-023 NVM_ProcessTransferData] as NVM_ProcessTransferData #FFC0CB
    [SWDD-002-001-019-024 NVM_ProcessRequestTransferExit] as NVM_ProcessRequestTransferExit #FFC0CB
    [SWDD-002-001-019-025 NVM_Session_Init] as NVM_Session_Init #FFC0CB
    [SWDD-002-001-019-026 NVM_Session_Change] as NVM_Session_Change #FFC0CB
    [SWDD-002-001-019-027 NVM_Session_GetCurrent] as NVM_Session_GetCurrent #FFC0CB
    [SWDD-002-001-019-028 NVM_Session_IsOperationAllowed] as NVM_Session_IsOperationAllowed #FFC0CB
    [SWDD-002-001-019-029 NVM_TransferManager_Init] as NVM_TransferManager_Init #FFC0CB
    [SWDD-002-001-019-030 NVM_TransferManager_StartTransfer] as NVM_TransferManager_StartTransfer #FFC0CB
    [SWDD-002-001-019-031 NVM_TransferManager_TransferData] as NVM_TransferManager_TransferData #FFC0CB
    [SWDD-002-001-019-032 NVM_TransferManager_CompleteTransfer] as NVM_TransferManager_CompleteTransfer #FFC0CB
    [SWDD-002-001-019-033 NVM_TransferManager_GetStatus] as NVM_TransferManager_GetStatus #FFC0CB
    [SWDD-002-001-019-034 NVM_Utils_CalculateCRC32] as NVM_Utils_CalculateCRC32 #FFC0CB
    [SWDD-002-001-019-035 NVM_Utils_ConvertToLittleEndian] as NVM_Utils_ConvertToLittleEndian #FFC0CB
    [SWDD-002-001-019-036 NVM_Utils_ConvertFromLittleEndian] as NVM_Utils_ConvertFromLittleEndian #FFC0CB
    [SWDD-002-001-019-037 NVM_Utils_IsAddressValid] as NVM_Utils_IsAddressValid #FFC0CB
    [SWDD-002-001-019-038 NVM_Init] as NVM_Init #FFC0CB
    [SWDD-002-001-019-039 NVM_MainFunction] as NVM_MainFunction #FFC0CB
    [SWDD-002-001-019-040 NVM_ProcessService] as NVM_ProcessService #FFC0CB
    [SWDD-002-001-019-041 NVM_AppendCRC32] as NVM_AppendCRC32 #FFC0CB
}

@enduml
